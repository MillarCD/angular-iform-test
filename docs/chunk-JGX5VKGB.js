import{a as D,c as R,d,e as j,f as M,g as k,i as q,j as G,l as I,m as B}from"./chunk-5YQL5I6I.js";import{A as p,D as c,F as u,G as i,H as o,I as C,J as L,K as r,M as _,R as A,T as N,X as T,c as S,g as F,k as E,n as m,s as y,t as l,w as P}from"./chunk-XE44CHX7.js";var H=D.backendUrl,g=class t{http=m(N);login(n,a,e){return this.http.post(`${H}/auth/login`,{email:n,password:a,token:e}).pipe(F(s=>(console.log("response: ",s),s.status==="success")))}static \u0275fac=function(a){return new(a||t)};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};var U=t=>({"border-red-500":t});function O(t,n){t&1&&(i(0,"div",10),r(1," Email is required "),o())}function Y(t,n){t&1&&(i(0,"div",10),r(1," Please enter a valid email address "),o())}function Z(t,n){t&1&&(i(0,"div",10),r(1," Password is required "),o())}function $(t,n){t&1&&(i(0,"div",10),r(1," Password must be at least 6 characters "),o())}function z(t,n){t&1&&(i(0,"div",15),r(1," Login successful! Redirecting... "),o())}var f=class t{fb=m(I);router=m(T);submitted=y(!1);showSuccessMessage=y(!1);authService=m(g);loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]]});onSubmit(){if(this.submitted.set(!0),this.loginForm.invalid)return;let{email:n="",password:a=""}=this.loginForm.value;if(!window.grecaptcha){console.error("reCAPTCHA no est\xE1 cargado.");return}window.grecaptcha.ready(()=>S(this,null,function*(){let e=yield window.grecaptcha.execute("6Lcm2BorAAAAADej42ZZ9wcnmi8Bmeht3E0YoUyY",{action:"submit"});console.log("Login submitted:",this.loginForm.value),this.authService.login(n,a,e).subscribe(s=>{if(!s){console.log("Fail to authenticate");return}this.showSuccessMessage.set(!0),setTimeout(()=>{this.showSuccessMessage.set(!1),this.router.navigate(["/admin"])},2e3)})}))}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=P({type:t,selectors:[["app-login-page"]],decls:25,vars:12,consts:[[1,"flex","min-h-screen","items-center","justify-center","p-4"],[1,"w-full","max-w-md","bg-white","rounded-lg","shadow-md","overflow-hidden"],[1,"p-6","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"p-6",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"space-y-2"],["for","email",1,"block","text-sm","font-medium","text-gray-700"],["id","email","formControlName","email","type","email","placeholder","your.email@example.com",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngClass"],[1,"text-red-500","text-xs","mt-1"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["id","password","formControlName","password","type","password","placeholder","Enter your password",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngClass"],[1,"mt-6"],["type","submit",1,"w-full","flex","justify-center","py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500"],[1,"mt-4","p-3","bg-green-100","text-green-700","rounded-md"]],template:function(a,e){if(a&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),r(4,"Login"),o(),i(5,"p",4),r(6,"Please enter your credentials to log in."),o()(),i(7,"form",5),L("ngSubmit",function(){return e.onSubmit()}),i(8,"div",6)(9,"div",7)(10,"label",8),r(11,"Email Address"),o(),C(12,"input",9),p(13,O,2,0,"div",10)(14,Y,2,0,"div",10),o(),i(15,"div",7)(16,"label",11),r(17,"Password"),o(),C(18,"input",12),p(19,Z,2,0,"div",10)(20,$,2,0,"div",10),o()(),i(21,"div",13)(22,"button",14),r(23," Login "),o()(),p(24,z,2,0,"div",15),o()()()),a&2){let s,b,v,x,h,w;l(7),c("formGroup",e.loginForm),l(5),c("ngClass",_(8,U,e.submitted()&&((s=e.loginForm.get("email"))==null?null:s.errors))),l(),u(e.submitted()&&(!((b=e.loginForm.get("email"))==null||b.errors==null)&&b.errors.required)?13:-1),l(),u(e.submitted()&&(!((v=e.loginForm.get("email"))==null||v.errors==null)&&v.errors.email)?14:-1),l(4),c("ngClass",_(10,U,e.submitted()&&((x=e.loginForm.get("password"))==null?null:x.errors))),l(),u(e.submitted()&&(!((h=e.loginForm.get("password"))==null||h.errors==null)&&h.errors.required)?19:-1),l(),u(e.submitted()&&(!((w=e.loginForm.get("password"))==null||w.errors==null)&&w.errors.minlength)?20:-1),l(4),u(e.showSuccessMessage()?24:-1)}},dependencies:[B,k,R,j,M,q,G,A],encapsulation:2,changeDetection:0})};var J=[{path:"login",component:f}],fe=J;export{fe as default};
